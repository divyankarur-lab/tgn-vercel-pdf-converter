<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TGN Agreement PDF Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f5f5f5; 
        }
        .generator-container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .status { 
            padding: 10px; 
            border-radius: 4px; 
            margin: 10px 0; 
            text-align: center;
        }
        .loading { background: #e3f2fd; color: #1976d2; }
        .success { background: #e8f5e8; color: #2e7d32; }
        .error { background: #ffebee; color: #c62828; }
        #content { 
            border: 5px solid #34C759; 
            padding: 40px; 
            margin: 20px 0;
            background: white;
            font-family: Arial, sans-serif;
        }
        #content img { 
            width: 100px; 
            height: auto; 
            display: block; 
            margin: 0 auto 20px;
        }
        #content h1 { 
            text-align: center; 
            font-size: 40px; 
            color: #1c1c1c; 
            margin: 0 0 20px 0;
        }
        #content .goodwill { color: #34C759; }
        #content hr { 
            border: 0; 
            height: 1px; 
            background: #e0e5ec; 
            margin: 20px 0; 
        }
        #content p { 
            font-size: 18px; 
            line-height: 1.5; 
            margin: 15px 0;
        }
        button {
            background: #34C759;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #2da94b; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .input-group {
            margin: 20px 0;
        }
        label {
            display: block;
            margin: 10px 0 5px 0;
            font-weight: bold;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <div class="generator-container">
        <h1>üìÑ TGN Agreement PDF Generator</h1>
        <div id="status" class="status loading">‚úÖ Ready to generate PDF</div>
        
        <div class="input-group">
            <label for="freelancerName">Freelancer Name:</label>
            <input type="text" id="freelancerName" value="John Smith" placeholder="Enter freelancer name">
        </div>
        
        <div class="input-group">
            <label for="producerName">Producer Name:</label>
            <input type="text" id="producerName" value="Jane Producer" placeholder="Enter producer name">
        </div>
        
        <div class="input-group">
            <label for="projectDetails">Project Details:</label>
            <textarea id="projectDetails" placeholder="Enter project details (optional)">Web development project for e-commerce platform including frontend and backend development.</textarea>
        </div>
        
        <button onclick="generatePDF()" id="generateBtn">üìÑ Generate PDF</button>
        <button onclick="updatePreview()" id="previewBtn">üëÄ Update Preview</button>
        
        <div id="content">
            <img src="https://ik.imagekit.io/divyankarur/o__2_-removebg-preview.png?updatedAt=1755246312760" alt="TGN Logo">
            <h1>the <span class="goodwill">goodwill</span> agreement</h1>
            <hr>
            <p><strong>Freelancer:</strong> <span id="preview-freelancer">John Smith</span></p>
            <p><strong>Producer:</strong> <span id="preview-producer">Jane Producer</span></p>
            <p><strong>Project:</strong> <span id="preview-project">Web development project for e-commerce platform including frontend and backend development.</span></p>
            <hr>
            <p>This Agreement establishes the terms and conditions for collaboration between the above parties in accordance with The Good Will Network's principles of mutual respect, fair compensation, and professional excellence.</p>
            <p>Both parties agree to maintain open communication, deliver quality work, and uphold the values of integrity and goodwill throughout the project duration.</p>
        </div>
    </div>

    <script>
        // Update preview with form data
        function updatePreview() {
            document.getElementById('preview-freelancer').textContent = 
                document.getElementById('freelancerName').value || 'Freelancer Name';
            document.getElementById('preview-producer').textContent = 
                document.getElementById('producerName').value || 'Producer Name';  
            document.getElementById('preview-project').textContent = 
                document.getElementById('projectDetails').value || 'Project details to be specified';
        }

        // Generate PDF function
        async function generatePDF() {
            try {
                document.getElementById('status').innerHTML = 'üîÑ Generating PDF...';
                document.getElementById('status').className = 'status loading';
                document.getElementById('generateBtn').disabled = true;
                
                // Update preview before generating
                updatePreview();
                
                // Create temporary container for PDF generation
                const sourceDiv = document.getElementById('content');
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = sourceDiv.innerHTML;
                
                // Better styling for PDF conversion
                tempDiv.style.width = '794px'; // A4 width in pixels
                tempDiv.style.minHeight = '1123px'; // A4 height in pixels  
                tempDiv.style.padding = '40px';
                tempDiv.style.margin = '0';
                tempDiv.style.backgroundColor = 'white';
                tempDiv.style.fontFamily = 'Arial, sans-serif';
                tempDiv.style.fontSize = '16px';
                tempDiv.style.lineHeight = '1.5';
                tempDiv.style.color = 'black';
                tempDiv.style.position = 'absolute';
                tempDiv.style.top = '-9999px';
                tempDiv.style.left = '-9999px';
                tempDiv.style.border = '5px solid #34C759';
                
                // Style all elements
                const allElements = tempDiv.querySelectorAll('*');
                allElements.forEach(el => {
                    el.style.fontFamily = 'Arial, sans-serif';
                });
                
                // Style specific elements
                const h1 = tempDiv.querySelector('h1');
                if (h1) {
                    h1.style.textAlign = 'center';
                    h1.style.fontSize = '40px';
                    h1.style.color = '#1c1c1c';
                    h1.style.margin = '0 0 20px 0';
                }
                
                const goodwillSpan = tempDiv.querySelector('.goodwill');
                if (goodwillSpan) goodwillSpan.style.color = '#34C759';
                
                const img = tempDiv.querySelector('img');
                if (img) {
                    img.style.width = '100px';
                    img.style.height = 'auto';
                    img.style.display = 'block';
                    img.style.margin = '0 auto 20px';
                }
                
                const hrs = tempDiv.querySelectorAll('hr');
                hrs.forEach(hr => {
                    hr.style.border = '0';
                    hr.style.height = '1px';
                    hr.style.background = '#e0e5ec';
                    hr.style.margin = '20px 0';
                });
                
                const ps = tempDiv.querySelectorAll('p');
                ps.forEach(p => {
                    p.style.fontSize = '18px';
                    p.style.lineHeight = '1.5';
                    p.style.margin = '15px 0';
                });
                
                document.body.appendChild(tempDiv);
                
                // Wait for images to load
                const images = tempDiv.querySelectorAll('img');
                const imagePromises = Array.from(images).map(img => {
                    return new Promise((resolve) => {
                        if (img.complete) {
                            resolve();
                        } else {
                            img.onload = resolve;
                            img.onerror = resolve;
                            setTimeout(resolve, 5000);
                        }
                    });
                });
                
                await Promise.all(imagePromises);
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // PDF generation options
                const options = {
                    margin: [10, 10, 10, 10],
                    filename: 'goodwill-agreement.pdf',
                    image: { 
                        type: 'jpeg', 
                        quality: 0.95
                    },
                    html2canvas: { 
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: true,
                        letterRendering: true,
                        width: 794,
                        height: 1123
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait'
                    }
                };
                
                // Generate PDF
                await html2pdf().set(options).from(tempDiv).save();
                
                // Clean up
                document.body.removeChild(tempDiv);
                
                document.getElementById('status').innerHTML = 'üéâ PDF generated and downloaded successfully!';
                document.getElementById('status').className = 'status success';
                document.getElementById('generateBtn').disabled = false;
                
            } catch (error) {
                console.error('PDF generation error:', error);
                document.getElementById('status').innerHTML = '‚ùå Error generating PDF: ' + error.message;
                document.getElementById('status').className = 'status error';
                document.getElementById('generateBtn').disabled = false;
            }
        }

        // Auto-update preview when typing
        document.getElementById('freelancerName').addEventListener('input', updatePreview);
        document.getElementById('producerName').addEventListener('input', updatePreview);
        document.getElementById('projectDetails').addEventListener('input', updatePreview);
        
        // Initialize preview
        updatePreview();
    </script>
</body>
</html>